<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Horticalc GUI</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="page-header">
      <h1>Horticalc – Düngercalculator</h1>
      <div class="api-config">
        <label for="apiBase">API Base URL</label>
        <input id="apiBase" type="url" value="http://localhost:8000" />
        <button id="reloadData">Dünger laden</button>
      </div>
    </header>

    <main>
      <section class="block">
        <h2>Wasserwerte</h2>
        <p class="hint">Profile lokal speichern/laden und Osmose-Anteil berücksichtigen.</p>
        <div class="water-controls">
          <div class="water-control-group">
            <label for="waterProfileSelect">Profil auswählen</label>
            <div class="water-control-row">
              <select id="waterProfileSelect"></select>
              <button id="loadWaterProfile" type="button">Laden</button>
              <button id="resetWaterProfile" type="button">Reset Default</button>
            </div>
          </div>
          <div class="water-control-group">
            <label for="waterProfileName">Profilname zum Speichern</label>
            <div class="water-control-row">
              <input id="waterProfileName" type="text" placeholder="z.B. stadenburdenhard" />
              <button id="saveWaterProfile" type="button">Speichern</button>
            </div>
          </div>
          <div class="water-control-group water-settings">
            <div>
              <label for="osmosisPercent">Osmoseanteil (%)</label>
              <input id="osmosisPercent" type="number" min="0" max="100" step="1" value="0" />
            </div>
            <label class="toggle">
              <input id="waterUnitToggle" type="checkbox" />
              <span>mol/L Eingabe & Anzeige</span>
            </label>
          </div>
        </div>
        <div class="table-wrap">
          <table class="grid grid--form" id="waterValuesTable">
            <thead>
              <tr>
                <th>Parameter</th>
                <th>Wert</th>
                <th>Einheit</th>
              </tr>
            </thead>
            <tbody>
              <!-- rows inserted by JS -->
            </tbody>
          </table>
        </div>
      </section>

      <section class="block">
        <h2>Vorauswahl der Düngerkomponenten</h2>
        <div class="actions inline-actions">
          <button id="addFertilizerRow" type="button">+</button>
          <button id="removeFertilizerRow" type="button">-</button>
          <span class="inline-hint">Wähle Dünger aus der Datenbank, das Plus fügt weitere Zeilen hinzu.</span>
        </div>
        <div class="table-wrap">
          <table class="grid grid--form" id="fertilizerSelectTable">
            <colgroup>
              <col class="col-index" />
              <col class="col-name" />
              <col class="col-form" />
              <col class="col-weight" />
            </colgroup>
            <thead>
              <tr>
                <th>#</th>
                <th>Dünger (Dropdown)</th>
                <th>Form</th>
                <th>Gewicht</th>
              </tr>
            </thead>
            <tbody>
              <!-- rows inserted by JS -->
            </tbody>
          </table>
        </div>
      </section>

      <section class="block">
        <h2>Düngercalculator</h2>
        <p class="hint">Mengen eingeben und Berechnung starten.</p>
        <div class="table-wrap">
          <table class="grid grid--form" id="calculatorTable">
            <colgroup>
              <col class="col-index" />
              <col class="col-name" />
              <col class="col-amount" />
            </colgroup>
            <thead>
              <tr>
                <th>#</th>
                <th>Düngername</th>
                <th>Menge (g)</th>
              </tr>
            </thead>
            <tbody>
              <!-- rows inserted by JS -->
            </tbody>
          </table>
        </div>
        <div class="actions">
          <button id="calculateBtn">Berechnen</button>
        </div>
        <div class="summary">
          <h3>Gelöste Ionen: Dünger + Wasser (ppm, mg/l)</h3>
          <div class="ec-summary" id="ecSummary">
            EC 18&nbsp;°C / 25&nbsp;°C: <span id="ecValue">-</span>
          </div>
          <div class="table-card">
            <h3>Oxidformen & Ionen (ppm, mg/l)</h3>
            <div class="table-wrap">
              <table class="grid grid--matrix nutrient-grid nutrient-grid--summary" id="summaryTable"></table>
            </div>
          </div>
        </div>
      </section>

      <section class="block">
        <h2>Ionenbilanz</h2>
        <p class="hint">Bilanzwerte basieren auf den Ionen in meq/L.</p>
        <div class="data-grid">
          <div class="table-card">
            <h3>Ionen (meq/L)</h3>
            <div class="table-wrap">
              <table class="grid grid--data" id="ionMeqTable">
                <thead>
                  <tr>
                    <th>Ion</th>
                    <th>meq/L</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- rows inserted by JS -->
                </tbody>
              </table>
            </div>
          </div>
          <div class="table-card">
            <h3>Bilanz</h3>
            <div class="table-wrap">
              <table class="grid grid--data" id="ionBalanceTable">
                <thead>
                  <tr>
                    <th>Bilanz</th>
                    <th>Wert</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- rows inserted by JS -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </section>

    </main>

    <script src="app.js"></script>
  </body>
</html>
